"use strict";(self.webpackChunkstock_tracker=self.webpackChunkstock_tracker||[]).push([[592],{8275:(D,f,i)=>{i.d(f,{Pm:()=>h,Wd:()=>r,pu:()=>a});class a{constructor(l=0,n=0,p=0,d=0){this.change=l,this.openingPrice=n,this.currentPrice=p,this.highPrice=d}}class h{constructor(l,n,p=0,d=0){this.month=l,this.year=n,this.change=p,this.mspr=d,this.displayMonth="UNKNOWN",this.setupDisplayMonth(l)}setupDisplayMonth(l){if(l){const n=new Date;n.setMonth(l-1),this.displayMonth=n.toLocaleString("en-US",{month:"long"})}}}class r{constructor(l="",n,p){this.symbol=l,this.companyName=n,this.quote=p}}},4377:(D,f,i)=>{i.d(f,{q:()=>I});var a=i(9646),h=i(8505),r=i(262),c=i(4004),l=i(8275),n=i(8256);let p=(()=>{class s{constructor(){}saveItem(e,t){localStorage.setItem(e,JSON.stringify(t))}getItem(e){const t=localStorage.getItem(e);return t?JSON.parse(t):null}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var d=i(2340);let u=(()=>{class s{constructor(){}get isEnabled(){return!d.N.production}log(e,...t){this.isEnabled&&console.log(e,t)}error(e,...t){this.isEnabled&&console.error(e,t)}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var y=i(6895),m=i(529);let S=(()=>{class s{constructor(e,t){this.http=e,this.logger=t}fetchQuote(e){const t=this.buildUri(`quote?symbol=${e}`);return this.http.get(t).pipe((0,c.U)(o=>new l.pu(o.dp,o.o,o.c,o.h)),(0,r.K)(o=>(this.logger.error(o),(0,a.of)(null))))}fetchCompanyName(e){const t=this.buildUri(`search?q=${e}`);return this.http.get(t).pipe((0,c.U)(o=>this.findSuitableCompanyName(e,o)),(0,r.K)(o=>(this.logger.error(o),(0,a.of)(null))))}fetchSentimentData(e,t=new Date){const o=new Date(t.getFullYear(),t.getMonth(),0),g=this.formatDate(o),b=new Date(t.getFullYear(),t.getMonth()-3,1),M=this.formatDate(b),C=this.buildUri(`stock/insider-sentiment?symbol=${e}&from=${M}&to=${g}`);return this.http.get(C).pipe((0,c.U)(E=>E.data.map(k=>new l.Pm(k.month,k.year,k.change,k.mspr))),(0,r.K)(E=>(this.logger.error(E),(0,a.of)([]))))}findSuitableCompanyName(e,t){if(t.count<=0)return null;if(1===t.count)return t.result[0].description;const o=t.result.filter(g=>g.symbol===e);return o.length?o[0].description:t.result[0].description}buildUri(e){return`${s.BASE_URI}/${e}&token=${d.N.finnhubApiToken}`}formatDate(e){return(0,y.p6)(e,"yyyy-MM-dd","en-US")}}return s.BASE_URI="https://finnhub.io/api/v1",s.\u0275fac=function(e){return new(e||s)(n.LFG(m.eN),n.LFG(u))},s.\u0275prov=n.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),I=(()=>{class s{constructor(e,t,o){this.storage=e,this.logger=t,this.finnhubApi=o}get stocks(){return this.storage.getItem("stocks")??[]}addStock(e){const t=[...this.stocks];t.some(g=>g.symbol===e.symbol)?this.logger.log(`Stock with symbol "${e.symbol}" already exists!`):(t.push(e),this.storage.saveItem("stocks",t))}updateStock(e){const t=[...this.stocks],o=t.findIndex(g=>g.symbol===e.symbol);-1!==o?(t[o]=e,this.storage.saveItem("stocks",t)):this.logger.log(`Stock with symbol "${e.symbol}" doesn't exist!`)}getStockBySymbol(e){return[...this.stocks].find(o=>o.symbol===e)??null}getCompanyName(e){const t=this.getStockBySymbol(e);return t?t.companyName?(0,a.of)(t.companyName):this.finnhubApi.fetchCompanyName(e).pipe((0,h.b)(o=>{null!==o&&(t.companyName=o,this.updateStock(t))}),(0,r.K)(o=>(this.logger.error(o),(0,a.of)(null)))):(0,a.of)(null)}getQuote(e){const t=this.getStockBySymbol(e);return t?t.quote?(0,a.of)(t.quote):this.finnhubApi.fetchQuote(e).pipe((0,h.b)(o=>{null!==o&&(t.quote=o,this.updateStock(t))}),(0,r.K)(o=>(this.logger.error(o),(0,a.of)(null)))):(0,a.of)(null)}getSentimentData(e,t=new Date){return this.finnhubApi.fetchSentimentData(e).pipe((0,c.U)(o=>[this.findSentiment(o,this.calcDate(1,t)),this.findSentiment(o,this.calcDate(2,t)),this.findSentiment(o,this.calcDate(3,t))]))}findSentiment(e,t){const o=t.getMonth()+1;return e.find(g=>g.month===o)??new l.Pm(o,t.getFullYear())}calcDate(e,t){return new Date(t.getFullYear(),t.getMonth()-e,1)}removeStock(e){const t=[...this.stocks],o=t.findIndex(g=>g.symbol===e);-1!==o?(t.splice(o,1),this.storage.saveItem("stocks",t)):this.logger.log(`Stock with symbol "${e}" doesn't exist!`)}}return s.\u0275fac=function(e){return new(e||s)(n.LFG(p),n.LFG(u),n.LFG(S))},s.\u0275prov=n.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},2123:(D,f,i)=>{i.d(f,{s:()=>d});var a=i(9646),h=i(4004),r=i(8256),c=i(4377),l=i(6895);function n(u,y){if(1&u&&(r.TgZ(0,"h1"),r._uU(1),r.qZA()),2&u){const m=y.ngIf;r.xp6(1),r.hij(" ",m,"\n")}}function p(u,y){1&u&&(r.TgZ(0,"h1"),r._uU(1,"\u23f3 Loading ..."),r.qZA())}let d=(()=>{class u{constructor(m){this.stockService=m,this.symbol="",this.showSymbol=!1,this.displayName$=(0,a.of)("Unknown")}ngOnInit(){this.displayName$=this.stockService.getCompanyName(this.symbol).pipe((0,h.U)(m=>{const S=m??"Unknown";return this.showSymbol?`${S} (${this.symbol})`:S}))}}return u.\u0275fac=function(m){return new(m||u)(r.Y36(c.q))},u.\u0275cmp=r.Xpm({type:u,selectors:[["app-company-name"]],inputs:{symbol:"symbol",showSymbol:"showSymbol"},decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["loading",""]],template:function(m,S){if(1&m&&(r.YNc(0,n,2,1,"h1",0),r.ALo(1,"async"),r.YNc(2,p,2,0,"ng-template",null,1,r.W1O)),2&m){const I=r.MAs(3);r.Q6J("ngIf",r.lcZ(1,2,S.displayName$))("ngIfElse",I)}},dependencies:[l.O5,l.Ov],styles:["h1[_ngcontent-%COMP%]{display:inline}"]}),u})()},4466:(D,f,i)=>{i.d(f,{m:()=>r});var a=i(6895),h=i(8256);let r=(()=>{class c{}return c.\u0275fac=function(n){return new(n||c)},c.\u0275mod=h.oAB({type:c}),c.\u0275inj=h.cJS({imports:[a.ez]}),c})()},6765:(D,f,i)=>{i.d(f,{x:()=>r});var a=i(8256);let r=(()=>{class c{constructor(n,p){this.el=n,this.renderer=p,this.change=0}set indicator(n){this.setIcon(n.icon),this.setColor(n.color)}ngOnInit(){this.setFontSize(),this.indicator=this.change>0?{icon:"&#11014;",color:"green"}:this.change<0?{icon:"&#11015;",color:"red"}:{icon:"&#8722;",color:"black"}}setFontSize(n=40){this.renderer.setStyle(this.el.nativeElement,"font-size",`${n}px`)}setIcon(n){this.renderer.setProperty(this.el.nativeElement,"innerHTML",n)}setColor(n){this.renderer.setStyle(this.el.nativeElement,"color",n)}}return c.\u0275fac=function(n){return new(n||c)(a.Y36(a.SBq),a.Y36(a.Qsj))},c.\u0275dir=a.lG2({type:c,selectors:[["","appTrendIndicator",""]],inputs:{change:"change"}}),c})()}}]);